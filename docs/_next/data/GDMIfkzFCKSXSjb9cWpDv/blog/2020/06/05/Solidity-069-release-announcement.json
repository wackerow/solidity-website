{"pageProps":{"frontmatter":{"layout":"post","published":true,"title":"Solidity 0.6.9 Release Announcement","date":"2020-06-05","author":"Solidity Team","category":"Releases"},"content":"\n[Solidity v0.6.9](https://github.com/ethereum/solidity/releases/tag/v0.6.9) adds SMT-checking to solc-js,\nallows `calldata` for all variables and provides a mechanism to specify an import directory.\n\nPlease note that the solc-js / soljson binary includes the Z3 SMT solver built-in, which causes an increase in the binary size.\n\n## Notable New Features\n\n### SMTChecker\n\nThe [SMTChecker](https://solidity.readthedocs.io/en/v0.6.8/security-considerations.html#formal-verification) is a component of the Solidity compiler which has been in development for quite some time now.\n\nIts aim is to bring formal verification methods to the Solidity compiler. Solidity implements a formal verification approach based on SMT/Horn solving. The SMTChecker module automatically tries to prove that the code satisfies the specification given by `require/assert` statements. The SMTChecker also checks automatically for arithmetic underflow/overflow, trivial conditions,\nunreachable code, and popping empty storage arrays.\n\nSo far, the SMTChecker has lacked an easy and convenient way to be used.\nThe difficulty lies in the fact that it requires an SMT solver to be compiled or linked into the compiler. To aid that, we are now shipping solc-js with the SMT solver Z3 compiled in. This means you can directly use the SMTChecker with everything\nthat uses solc-js - including [Remix](https://remix.ethereum.org/)!\n\nBelow, you find a simple example contract which shows an overflow check being reported. If you copy-paste it to Remix, it will show the error.\n\n```solidity\n// SPDX-License-Identifier: GPL-3.0\npragma solidity >=0.6.9;\npragma experimental SMTChecker;\n\ncontract Token {\n  mapping(address => uint) balances;\n  address owner;\n  constructor () public { owner = msg.sender; }\n  function transfer(address recipient, uint amount) public {\n    // If we comment out the next line, SMTChecker\n    // will complain about underflow.\n    require(balances[msg.sender] >= amount);\n    balances[msg.sender] -= amount;\n    // SMTChecker detects a possible overflow in the next line\n    // and even provides example inputs:\n    // Warning: Overflow (resulting value larger than 2**256 - 1) happens here\n    // for:\n    // <result> = 2**256\n    // amount = 1\n    // balances[msg.sender] = 0\n    // balances[recipient] = 2**256 - 1\n    balances[recipient] += amount;\n  }\n  function mint(address recipient, uint amount) public {\n      require(msg.sender == owner);\n      balances[recipient] += amount;\n  }\n}\n```\n\nThe component can also analyze more complex cases including possible call chains from external callers, as demonstrated in the following buggy state machine example:\n\n```solidity\n// SPDX-License-Identifier: GPL-3.0\npragma solidity >=0.6.9;\npragma experimental SMTChecker;\n\ncontract StateMachine {\n    enum State { Init, End }\n    State state;\n    uint[] a;\n\n    constructor() public {\n        state = State.Init;\n        a.push();\n    }\n\n    function move() public {\n        require(state == State.Init);\n        state = State.End;\n        a.pop();\n    }\n\n    function reset() public {\n        require(state == State.End);\n        state = State.Init;\n        a.pop();\n    }\n}\n```\n\nA sequence of 3 transactions (deployment, `move`, `reset`) causes an empty array pop, where SMTChecker then reports:\n\n```solidity\nbrowser/state_machine.sol:24:9: Warning: Empty array \"pop\" detected here.\n        a.pop();\n        ^-----^\n```\n\nNote that the SMTChecker makes several queries to the SMT solver, which might take some time since it is a computationally expensive procedure.\n\n### Calldata Variables\n\nYou can now use `calldata` as the data location for reference variables everywhere, not only in external functions. Note that since the EVM does not allow modification of calldata, you cannot create new values in calldata or copy something to calldata.\n\n```solidity\n// SPDX-License-Identifier: GPL-3.0\npragma solidity >=0.6.9;\n\ncontract C {\n  address[] owners;\n  function addOwners(address[] calldata _newOwners) public {\n    // We pass _newOwners on as a calldata array.\n    checkUnique(_newOwners);\n    for (uint i = 0; i < _newOwners.length; i++)\n      owners.push(_newOwners[i]);\n  }\n  /// This internal function can iterate over the calldata array.\n  /// Creating a copy in memory is not required.\n  function checkUnique(address[] calldata _newOwners) internal pure {\n    for (uint i = 0; i < _newOwners.length; i++)\n      for (uint j = i + 1; j < _newOwners.length; j++)\n        require(_newOwners[i] != _newOwners[j]);\n  }\n}\n```\n\nThe benefit of using calldata variables is that it saves\na copy from calldata to memory and you can be sure that the\narray or struct cannot be modified.\n\nUsually, the ABI decoder performs range checks on the entire calldata when it is copied to memory to avoid malformed calldata from causing any problems.\nNote that when using calldata variables for nested calldata structs or arrays those checks will instead only be performed when you access them.\n\n### BasePath\n\nWith the introduction of the `--base-path` option to both\nsolc and solcjs, we hope that imports will be easier to use.\n\nIf you run `solc --base-path ./contracts/ ./contracts/MainContract.sol`\nand that file contains `import \"./OtherContract.sol\";`, the Solidity\ncompiler will automatically search for `./contracts/OtherContract.sol`\nand import it.\n\nWhile this sounds like a pretty trivial feature, we hope that you still like it!\n\nAlso note that if you use `--base-path`, the base path itself will\nnot be included in any metadata artefacts, you will only get relative\npaths starting from the base path.\n\n## Full Changelog\n\n### Language Features\n\n- Permit calldata location for all variables.\n- **NatSpec**: Support NatSpec comments on state variables.\n- **Yul**: EVM instruction `pc()` is marked deprecated and will be removed in the next breaking release.\n\n### Compiler Features\n\n- **Build system**: Update the soljson.js build to emscripten 1.39.15 and boost 1.73.0 and include Z3 for integrated SMTChecker support without the callback mechanism.\n- **Build system**: Switch the emscripten build from the fastcomp backend to the upstream backend.\n- **Code Generator**: Do not introduce new internal source references for small compiler routines.\n- **Commandline Interface**: Adds new option `--base-path PATH` to use the given path as the root of the source tree (defaults to the root of the filesystem).\n- **SMTChecker**: Support array `length`.\n- **SMTChecker**: Support array `push` and `pop`.\n- **SMTChecker**: General support to BitVectors and the bitwise `and` operator.\n\n## Bugfixes\n\nThis release comes with many minor, non-security relevant bugfixes. The correspoding bugs do not affect (the correctness of) the generated\nbytecode.\n\nYou can track all important, security-relevant bugs in the [Solidity bug json file](https://github.com/ethereum/solidity/blob/develop/docs/bugs.json).\n\n- **Code Generator**: Trigger proper unimplemented errors on certain array copy operations.\n- **Commandline Interface**: Fix internal error when using `--assemble` or `--yul` options with `--machine ewasm` but without specifying `--yul-dialect`.\n- **NatSpec**: DocString block is terminated when encountering an empty line.\n- **Optimizer**: Fixed a bug in BlockDeDuplicator.\n- **Scanner**: Fix bug when two empty NatSpec comments lead to scanning past EOL.\n- **SMTChecker**: Fix internal error on try/catch clauses with parameters.\n- **SMTChecker**: Fix internal error when applying arithmetic operators to fixed point variables.\n- **SMTChecker**: Fix internal error when assigning to index access inside branches.\n- **SMTChecker**: Fix internal error when short circuiting Boolean expressions with function calls in state variable initialization.\n- **Type Checker**: Disallow assignments to storage variables of type `mapping`.\n- **Type Checker**: Disallow inline arrays of non-nameable types.\n- **Type Checker**: Disallow usage of override with non-public state variables.\n- **Type Checker**: Fix internal compiler error when accessing members of array slices.\n- **Type Checker**: Fix internal compiler error when forward referencing non-literal constants from inline assembly.\n- **Type Checker**: Fix internal compiler error when trying to decode too large static arrays.\n- **Type Checker**: Fix wrong compiler error when referencing an overridden function without calling it.\n\nLast but not least, as always, we'd like to thank all contributors who helped make this release possible!\n\nYou can download the new version of Solidity [here](https://github.com/ethereum/solidity/releases/tag/v0.6.9).\n","availableURLs":["/2023/05/10/solidity-0.8.20-release-announcement","/2023/03/10/solidity-developer-survey-2022-results","/2023/02/22/user-defined-operators","/2023/02/22/solidity-0.8.19-release-announcement","/2023/02/01/solidity-0.8.18-release-announcement","/2022/12/07/solidity-developer-survey-2022-announcement","/2022/12/05/solidity-core-team-updates","/2022/09/08/storage-write-removal-before-conditional-termination","/2022/09/08/solidity-0.8.17-release-announcement","/2022/08/08/solidity-0.8.16-release-announcement","/2022/08/08/calldata-tuple-reencoding-head-overflow-bug","/2022/06/15/solidity-0.8.15-release-announcement","/2022/06/15/inline-assembly-memory-side-effects-bug","/2022/06/15/dirty-bytes-array-to-storage-bug","/2022/05/17/solidity-0.8.14-release-announcement","/2022/05/17/data-location-inheritance-bug","/2022/05/17/calldata-reencode-size-check-bug","/2022/05/03/solidity-summit-2022-recap","/2022/04/08/announcing-the-underhanded-contest-winners-2022","/2022/03/16/solidity-0.8.13-release-announcement","/2022/03/16/encodecall-bug","/2022/02/22/solidity-summit-2022-announcement","/2022/02/16/solidity-0.8.12-release-announcement","/2022/02/09/underhanded-solidity-contest-2022-announcement","/2022/02/07/solidity-developer-survey-2021-results","/2021/12/20/solidity-0.8.11-release-announcement","/2021/11/18/solidity-developer-survey-2021","/2021/11/09/solidity-0.8.10-release-announcement","/2021/09/29/user-defined-value-types-bug","/2021/09/29/solidity-0.8.9-release-announcement","/2021/09/29/signed-immutables-bug","/2021/09/27/user-defined-value-types","/2021/09/27/solidity-0.8.8-release-announcement","/2021/08/11/solidity-0.8.7-release-announcement","/2021/06/22/solidity-0.8.6-release-announcement","/2021/06/10/solidity-0.8.5-release-announcement","/2021/05/03/soliditylangorg-umbrella-domain","/2021/04/21/solidity-0.8.4-release-announcement","/2021/04/21/decoding-from-memory-bug","/2021/04/21/custom-errors","/2021/04/01/announcing-solidity-collectibles","/2021/03/23/solidity-0.8.3-release-announcement","/2021/03/23/keccak-optimizer-bug","/2021/03/02/solidity-0.8.2-release-announcement","/2021/03/02/saving-gas-with-simple-inliner","/2021/02/15/contributing-to-solidity-101","/2021/02/10/an-introduction-to-soliditys-fuzz-testing-approach","/2021/02/01/launching-the-solidity-forum","/2021/01/27/solidity-0.8.1-release-announcement","/2021/01/26/solidity-developer-survey-2020-results","/2020/12/16/solidity-v0.8.0-release-announcement","/2020/12/16/solidity-0.7.6-release-announcement","/2020/12/09/solidity-developer-survey-2020","/2020/12/03/solidity-underhanded-contest-winners","/2020/11/18/solidity-0.7.5-release-announcement","/2020/11/04/solidity-ama-1-recap","/2020/10/28/solidity-0.8.x-preview","/2020/10/19/solidity-0.7.4-release-announcement","/2020/10/19/empty-byte-array-copy-bug","/2020/10/07/solidity-dynamic-array-cleanup-bug","/2020/10/07/solidity-0.7.3-release-announcement","/2020/09/28/solidity-0.7.2-release-announcement","/2020/09/21/solidity-underhanded-contest","/2020/09/18/meet-the-team","/2020/09/02/solidity-0.7.1-release-announcement","/2020/07/28/solidity-v0.7.0-release-announcement","/2020/07/22/Solidity-0612-release-announcement","/2020/07/08/solidity-turns-5","/2020/07/07/Solidity-0611-release-announcement","/2020/06/25/sourcify-faq","/2020/06/18/solidity-0.6-inheritance","/2020/06/11/Solidity-0610-release-announcement","/2020/06/09/solidity-summit-recap","/2020/06/05/Solidity-069-release-announcement","/2020/06/02/Sourcify-Towards-Safer-Contract-Interaction-for-Humans","/2020/05/26/array-slices","/2020/05/14/Solidity-068-release-announcement","/2020/05/13/immutable-keyword","/2020/05/04/solidity-0.6.7-release-announcement","/2020/04/17/Solidity-Summit-2020-Goes-Interspace","/2020/04/09/solidity-0.6.6-release-announcement","/2020/04/06/solidity-0.6.5-release-announcement","/2020/04/06/memory-creation-overflow-bug","/2020/03/23/fallback-receive-split","/2020/03/17/solidity-0.5.17-release-announcement","/2020/03/10/solidity-0.6.4-release-announcement","/2020/02/18/solidity-0.6.3-release-announcement","/2020/01/29/solidity-0.6-try-catch","/2020/01/27/solidity-0.6.2-release-announcement","/2020/01/02/solidity-0.6.1-release-announcement","/2020/01/02/solidity-0.5.16-release-announcement","/2019/12/17/solidity-0.6.0-release-announcement","/2019/12/17/solidity-0.5.15-release-announcement","/2019/12/09/solidity-0.5.14-release-announcement","/2019/11/14/solidity-0.5.13-release-announcement","/2019/10/01/solidity-0.5.12-release-announcement","/2019/08/12/solidity-0.5.11-release-announcement","/2019/06/25/solidity-storage-array-bugs","/2019/06/25/solidity-0.5.10-release-announcement","/2019/05/28/solidity-0.5.9-release-announcement","/2019/04/30/solidity-0.5.8-release-announcement","/2019/04/29/solidity-0.4.26-release-announcement","/2019/03/26/solidity-optimizer-and-abiencoderv2-bug","/2019/03/26/solidity-0.5.7-release-announcement","/2019/03/13/solidity-0.5.6-release-announcement","/2019/03/05/solidity-0.5.5-release-announcement","/2019/02/12/solidity-0.5.4-release-announcement","/2019/01/22/solidity-0.5.3-release-announcement","/2018/12/19/solidity-0.5.2-release-announcement","/2018/12/03/solidity-0.5.1-release-announcement","/2018/11/13/solidity-0.5.0-release-announcement","/2018/09/13/solidity-bugfix-release","/2018/09/13/solidity-0.4.25-release-announcement","/2018/05/16/solidity-0.4.24-release-announcement","/2018/04/19/solidity-0.4.23-release-announcement","/2018/04/17/solidity-0.4.22-release-announcement","/2018/03/08/solidity-0.4.21-release-announcement","/2018/02/14/solidity-0.4.20-release-announcement","/2017/11/30/solidity-0.4.19-release-announcement","/2017/10/18/solidity-0.4.18-release-announcement","/2017/09/21/solidity-0.4.17-release-announcement","/2017/08/24/solidity-0.4.16-release-announcement","/2017/08/08/solidity-0.4.15-release-announcement","/2017/07/31/solidity-0.4.14-release-announcement","/2017/07/06/solidity-0.4.13-release-announcement","/2017/07/03/solidity-0.4.12-release-announcement","/2017/05/03/solidity-optimizer-bug","/2017/05/03/solidity-0.4.11-release-announcement","/2017/03/15/solidity-0.4.10-release-announcement","/2017/01/31/solidity-0.4.9-release-announcement","/2017/01/13/solidity-0.4.8-release-announcement","/2016/12/15/solidity-0.4.7-release-announcement","/2016/11/22/solidity-0.4.6-release-announcement","/2016/11/21/solidity-0.4.5-release-announcement","/2016/11/09/analysis-storage-corruption-bug","/2016/11/01/solidity-0.4.4-release-announcement","/2016/11/01/security-alert-solidity-variables-can-overwritten-storage","/2016/10/25/solidity-0.4.3-release-announcement","/2016/09/17/solidity-0.4.2-release-announcement","/2016/09/09/solidity-0.4.1-release-announcement","/2016/09/08/solidity-0.4.0-release-announcement","/2016/09/01/formal-methods-roadmap","/2016/08/10/solidity-0.3.6-release-announcement","/2016/06/10/solidity-0.3.5-release-announcement","/2016/06/10/smart-contract-security","/2016/05/31/solidity-0.3.4-release-announcement","/2016/05/27/solidity-0.3.3-release-announcement","/2016/04/18/solidity-0.3.2-release-announcement","/2016/03/31/solidity-0.3.1-release-announcement","/2016/03/11/solidity-0.3.0-release-announcement","/2016/02/17/solidity-0.2.2-release-announcement","/2016/01/30/solidity-0.2.1-release-announcement","/2015/12/01/solidity-0.2.0-release-announcement","/2015/11/17/solidity-0.1.7-release-announcement","/2015/10/16/solidity-0.1.6-release-announcement","/2015/10/07/solidity-0.1.5-release-announcement","/2015/09/30/solidity-0.1.4-release-announcement","/2015/09/22/solidity-0.1.3-release-announcement","/2015/08/21/solidity-0.1.2-release-announcement"]},"__N_SSG":true}